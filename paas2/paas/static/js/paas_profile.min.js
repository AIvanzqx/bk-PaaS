APP_PROFILE=function(){return{change_password:function(){$(".error_tip").hide(),$(".password_input").val(""),$("#password_tip").text(""),art.dialog({id:"bktips",title:"重置密码",lock:!0,width:500,content:$("#change_password_div").get(0),cancelVal:"取消",cancel:function(){},okVal:"重置密码",ok:function(){var t=!0;if($(".error_tip").hide(),$("#pattern_tip").css("color","black"),$(".password_input").each(function(){var o=$.trim($(this).val());return o?o.match(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[A-Za-z0-9!@#\$%\^\*\(\)-_\+=]{8,20}$/)||"password1"!=$(this).attr("name")?void 0:($("#pattern_tip").css("color","red"),$(this).focus(),t=!1,!1):($(this).next(".error_tip").show(),$(this).focus(),t=!1,!1)}),!t)return!1;var o=$.trim($("#id_old_password").val()),a=$.trim($("#id_password1").val().trim()),i=$.trim($("#id_password2").val().trim());if(a!=i&&($("#password_tip").text("两次输入的新密码不一致"),t=!1),!t)return!1;var r=BLUEKING.config.paas_host()+"accounts/user/password/",s=!0;if($.ajax({type:"POST",url:r,data:{old_password:o,new_password1:a,new_password2:i},success:function(t){t.result||($("#password_tip").text(t.message),s=!1)},dataType:"json",async:!1}),!s)return!1;art.dialog({width:300,icon:"succeed",lock:!0,content:"密码重置成功"}).time(1),window.location.href="/accounts/logout/"}})},show_modify_user:function(){var t=BLUEKING.config.paas_host()+"accounts/user/info/";$.get(t,{},function(t){art.dialog({id:"bktips",title:"修改个人信息",lock:!0,width:500,content:t})})},modify_user_info:function(){var t=$.trim($("#chname").val());if(!t.match(/^[\u4e00-\u9fa5a-zA-Z0-9_]{1,16}$/))return $("#error_tip").html('中文名只能包含数字、字母、中文汉字、<br><span style="margin-left:105px">下划线，长度在1-16个字符</span>'),$("#chname").focus(),!1;var o=$.trim($("#phone").val());if(!o.match(/^\d{11}$/))return $("#error_tip").text("仅支持中国大陆手机号码（11位数字）"),$("#phone").focus(),!1;var a=$.trim($("#email").val());if(!a.match(/^[A-Za-z0-9]+([-_.][A-Za-z0-9]+)*@([A-Za-z0-9]+[-.])+[A-Za-z0-9]{2,5}$/))return $("#error_tip").text("请输入正确的邮箱格式"),$("#email").focus(),!1;var i=site_url+"accounts/user/info/";$.post(i,{chname:t,phone:o,email:a},function(t){t.result?(art.dialog({id:"bktips"}).close(),art.dialog({id:"bktips",width:300,icon:"succeed",lock:!0,content:"用户信息修改成功"}),setTimeout(window.location.reload(),1e3)):$("#error_tip").text(t.message)},"json")},cancel_edit:function(){art.dialog({id:"bktips"}).close()}}}(),$("#show_password_change").on("click",APP_PROFILE.change_password),$("#show_modify_user").on("click",APP_PROFILE.show_modify_user);